
# 架构决策记录 (Architecture Decision Record - ADR)

## ADR-001: 确立纯客户端处理与静态部署架构

*   **状态**: 已接受
*   **日期**: 2024-08-01
*   **决策者**: 项目总监

### 背景 (Context)

项目需要支持处理更大的文件（最大 20MB）、新增 PDF 文件处理能力，并提供处理结果的预览功能。初步的技术构想涉及了服务器端处理。然而，一个关键的外部约束是：**项目必须能够部署在像 GitHub Pages 这样的静态网站托管平台上**。

静态托管平台不提供后端计算能力（如 Node.js 运行时），这意味着任何依赖服务器进行计算的方案都是不可行的。

### 决策 (Decision)

我们决定采用**纯客户端（浏览器端）架构**来完成所有核心业务逻辑。

具体架构选择如下：

1.  **PDF 渲染**: 所有 PDF 的解析和页面渲染，将使用 **`pdf.js-dist`** 库在用户浏览器中完成。
2.  **结果打包**: 分割后的多张图片将被使用 **`jszip`** 库在浏览器中直接打包成 ZIP 文件。
3.  **性能保障**: 为了防止处理大文件（高达 20MB）时阻塞浏览器主线程导致界面卡死，所有计算密集型任务（PDF渲染、图片分割）都必须在 **Web Worker** (后台线程) 中执行。
4.  **框架**: 继续使用 **Astro** 作为静态网站生成器，利用其优秀的组件化和前端构建能力。

### 后果 (Consequences)

**正面**:

*   **零服务器成本**: 无需购买、配置或维护后端服务器，显著降低了部署和运营成本。
*   **无限扩展性**: 由于计算发生在用户端，应用天然支持无限的用户规模，不会有服务器的性能瓶颈。
*   **数据隐私**: 用户文件无需上传到服务器，完全在本地处理，提供了极高的数据隐私保障。

**负面与风险**:

*   **用户设备依赖**: 应用的性能和稳定性完全取决于用户设备的性能（CPU, RAM）。在低端或移动设备上，处理大文件可能会很慢甚至导致浏览器崩溃。
*   **浏览器兼容性**: 需要充分测试 Web Worker, `pdf.js` 和 `Blob` API 在主流浏览器上的兼容性。
*   **开发复杂性增加**: 使用 Web Worker 会引入线程间通信的复杂性，调试起来比传统的单线程代码更具挑战性。
*   **代码安全性**: 所有处理逻辑都在前端，代码是公开可见的。对于本项目，这不构成安全风险，但对于包含专有算法的项目则需要注意。

--- 