# 多仓库架构改造需求文档

## 概述
本项目需要将现有的monorepo结构的长截图分割工具项目完全改造为多仓库架构。当前项目包含screenshot-splitter（主应用）和shared-components（共享组件库）两个包，使用pnpm workspace管理。改造目标是将这两个包拆分为独立的Git仓库，移除monorepo工具链，实现配置化改造，并使用public npm registry进行依赖管理。

## 功能需求

### 1. 仓库结构改造
**用户故事**: 作为项目架构师，我希望为多仓库架构做好技术准备，移除monorepo结构，但暂时保持单库部署模式。

**验收标准**:
1. ✅ 移除pnpm workspace配置和依赖
2. ✅ 重构项目结构为独立仓库模式
3. ✅ shared-components作为本地模块维护（未发布到npm）
4. ✅ 保持screenshot-splitter作为主应用仓库
5. ✅ 为未来完全分离做好技术准备

### 2. 依赖管理改造
**用户故事**: 作为开发者，我希望改造依赖管理方式，移除workspace依赖，为未来npm发布做好准备。

**验收标准**:
1. ✅ 移除所有workspace:*依赖声明
2. ✅ shared-components配置为可发布的npm包结构
3. ✅ 暂时保持shared-components作为本地模块维护
4. ✅ 配置package.json的publish相关脚本（为未来准备）
5. ✅ 依赖管理方式支持未来平滑过渡到npm依赖

### 3. 配置化改造
**用户故事**: 作为开发者，我希望将所有配置类代码抽到config目录，以便实现更好的可维护性和可配置性。

**验收标准**:
1. ✅ 识别并提取所有环境配置到config目录
2. ✅ 识别并提取所有构建配置到config目录  
3. ✅ 识别并提取所有应用配置到config目录
4. ✅ 配置文件使用统一的命名规范
5. ✅ 配置类代码与业务逻辑完全分离

### 4. 构建系统改造
**用户故事**: 作为构建工程师，我希望改造构建系统以适应多仓库架构，确保每个仓库可以独立构建。

**验收标准**:
1. ✅ screenshot-splitter拥有独立的构建配置
2. ✅ shared-components拥有独立的构建配置
3. ✅ 移除所有monorepo特有的构建工具和脚本
4. ✅ 每个仓库的构建过程不依赖其他仓库
5. ✅ 构建产物可以独立部署和使用

### 5. 开发体验优化
**用户故事**: 作为开发者，我希望保持流畅的开发体验，即使在多仓库架构下也能高效开发。

**验收标准**:
1. ✅ 提供本地开发时的依赖链接方案
2. ✅ 保持现有的热重载和调试功能
3. ✅ 文档说明多仓库开发流程
4. ✅ 提供快速切换开发的工具脚本
5. ✅ 保持测试框架的兼容性

## 非功能需求

### 1. 兼容性要求
- ✅ 保持现有功能完全不变
- ✅ 保持API接口兼容
- ✅ 保持用户体验一致

### 2. 性能要求  
- ✅ 构建性能不能显著下降
- ✅ 运行时性能保持现有水平
- ✅ 包体积不能显著增加

### 3. 可维护性要求
- ✅ 代码结构清晰，易于理解
- ✅ 配置集中管理，易于修改
- ✅ 文档完整，易于后续维护

### 4. 部署要求
- ✅ 支持独立部署每个仓库
- ✅ 部署流程简单可靠
- ✅ 支持回滚机制

## 技术约束

1. **禁止使用monorepo工具**: 完全移除pnpm workspace、lerna等monorepo管理工具
2. **使用public npm**: 依赖管理必须通过public npm registry进行
3. **配置集中化**: 所有配置必须抽到config目录统一管理
4. **无UI库重建**: 使用现有UI框架，不重复造轮子
5. **渐进式迁移**: 暂时保持单库部署，为未来完全分离做准备

## 成功标准

1. ✅ 项目结构完全移除monorepo特性
2. ✅ 依赖管理方式支持未来npm发布
3. ✅ 配置代码完全分离到config目录
4. ✅ 构建和部署流程正常工作
5. ✅ 现有功能完全保持，用户体验无变化
6. ✅ shared-components作为本地模块正常使用
